"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=_interopRequireDefault(require("react")),_router=require("next/router"),_gridList=_interopRequireDefault(require("../../video/player/gridList")),_ShopModule=_interopRequireDefault(require("./Shop.module.scss")),_ProductImageManagerModule=_interopRequireDefault(require("../product/ProductImageManager.module.scss")),_util=require("../../util"),_uuid=require("uuid"),_AllInclusive=_interopRequireDefault(require("@mui/icons-material/AllInclusive")),_ConfirmationNumber=_interopRequireDefault(require("@mui/icons-material/ConfirmationNumber")),_Inventory=_interopRequireDefault(require("@mui/icons-material/Inventory")),_Stadium=_interopRequireDefault(require("@mui/icons-material/Stadium")),_Tooltip=_interopRequireDefault(require("@mui/material/Tooltip")),_reactTextareaAutosize=_interopRequireDefault(require("react-textarea-autosize")),_ecommerce=require("../../utility/ecommerce"),_product=require("../product"),_signin=require("../../onboarding/signin"),_Functions=require("./Functions");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return o};var u,o={},e=Object.prototype,c=e.hasOwnProperty,s=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",a=t.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(u){l=function(e,t,r){return e[t]=r}}function i(e,t,r,n){var a,l,o,i,t=t&&t.prototype instanceof _?t:_,t=Object.create(t.prototype),n=new O(n||[]);return s(t,"_invoke",{value:(a=e,l=r,o=n,i=f,function(e,t){if(i===m)throw new Error("Generator is already running");if(i===y){if("throw"===e)throw t;return{value:u,done:!0}}for(o.method=e,o.arg=t;;){var r=o.delegate;if(r){r=function e(t,r){var n=r.method,a=t.iterator[n];if(a===u)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=u,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;n=d(a,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,g;a=n.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=u),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}(r,o);if(r){if(r===g)continue;return r}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(i===f)throw i=y,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i=m;r=d(a,l,o);if("normal"===r.type){if(i=o.done?y:p,r.arg===g)continue;return{value:r.arg,done:o.done}}"throw"===r.type&&(i=y,o.method="throw",o.arg=r.arg)}})}),t}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}o.wrap=i;var f="suspendedStart",p="suspendedYield",m="executing",y="completed",g={};function _(){}function h(){}function v(){}var t={},b=(l(t,n,function(){return this}),Object.getPrototypeOf),b=b&&b(b(I([]))),E=(b&&b!==e&&c.call(b,n)&&(t=b),v.prototype=_.prototype=Object.create(t));function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function S(o,i){var t;s(this,"_invoke",{value:function(r,n){function e(){return new i(function(e,t){!function t(e,r,n,a){var l,e=d(o[e],o,r);if("throw"!==e.type)return(r=(l=e.arg).value)&&"object"==_typeof(r)&&c.call(r,"__await")?i.resolve(r.__await).then(function(e){t("next",e,n,a)},function(e){t("throw",e,n,a)}):i.resolve(r).then(function(e){l.value=e,n(l)},function(e){return t("throw",e,n,a)});a(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function I(t){if(t||""===t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(c.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=u,e.done=!0,e}).next=e}throw new TypeError(_typeof(t)+" is not iterable")}return s(E,"constructor",{value:h.prototype=v,configurable:!0}),s(v,"constructor",{value:h,configurable:!0}),h.displayName=l(v,a,"GeneratorFunction"),o.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,a,"GeneratorFunction")),e.prototype=Object.create(E),e},o.awrap=function(e){return{__await:e}},T(S.prototype),l(S.prototype,r,function(){return this}),o.AsyncIterator=S,o.async=function(e,t,r,n,a){void 0===a&&(a=Promise);var l=new S(i(e,t,r,n),a);return o.isGeneratorFunction(t)?l:l.next().then(function(e){return e.done?e.value:l.next()})},T(E),l(E,a,"Generator"),l(E,n,function(){return this}),l(E,"toString",function(){return"[object Generator]"}),o.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},o.values=I,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&c.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=u)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return l.type="throw",l.arg=r,n.next=e,t&&(n.method="next",n.arg=u),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var a=this.tryEntries[t],l=a.completion;if("root"===a.tryLoc)return e("end");if(a.tryLoc<=this.prev){var o=c.call(a,"catchLoc"),i=c.call(a,"finallyLoc");if(o&&i){if(this.prev<a.catchLoc)return e(a.catchLoc,!0);if(this.prev<a.finallyLoc)return e(a.finallyLoc)}else if(o){if(this.prev<a.catchLoc)return e(a.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return e(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&c.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}var l=(a=a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc?null:a)?a.completion:{};return l.type=e,l.arg=t,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(l)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),x(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,a=this.tryEntries[t];if(a.tryLoc===e)return"throw"===(r=a.completion).type&&(n=r.arg,x(a)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:I(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=u),g}},o}function asyncGeneratorStep(e,t,r,n,a,l,o){try{var i=e[l](o),u=i.value}catch(e){return void r(e)}i.done?t(u):Promise.resolve(u).then(n,a)}function _asyncToGenerator(i){return function(){var e=this,o=arguments;return new Promise(function(t,r){var n=i.apply(e,o);function a(e){asyncGeneratorStep(n,t,r,a,l,"next",e)}function l(e){asyncGeneratorStep(n,t,r,a,l,"throw",e)}a(void 0)})}}function ownKeys(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,l,o,i=[],u=!0,c=!1;try{if(l=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var defaultEditingOptionsMeta={description:"",productType:"virtual",ticket:!1,livestream:!1,livestreamDef:{dates:[],tags:[],input:""},eventDateDef:{dates:[],input:""},lineup:[]},defaultDefinePriceCurrency={code:"US",name:"United States",payment:"stripe",region:"NORTH AMERICA",currency:"USD",symbol:"$"},Module=function(c){function L(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t={sid:(0,_uuid.v4)(),quantity:100};return e&&(t.option=""),t}function q(){return{price:10,currency:"USD",priceTable:{},sid:(0,_uuid.v4)(),style:"",option:[L(!1)]}}function R(){return{id:(0,_uuid.v4)(),title:"",description:"",time:null,image:""}}function F(t){console.log(t),(null!=_&&_.id||!_&&null!=c&&c.forceOpenRedirectOnDone)&&(E(defaultDefinePriceCurrency),m(t),setTimeout(function(){var e=_objectSpread({},t);e.name=t.name,m(e)},200))}function z(o,i){var u=2<arguments.length&&void 0!==arguments[2]&&arguments[2];try{return function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,r,n,a,l;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s)e.next=32;else{if(J({}),t=_objectSpread({},p),console.log(t),t.detailmeta=_objectSpread({},y),console.log("Publish Product",t),""===t.name)return J({message:"Please enter a name for your product",location:"product_name"}),d(!1),e.abrupt("return",1);e.next=10}break;case 10:return r=X,n=Z,h&&h.editing===t.id&&(h.images.forEach(function(e){console.log("Img",e),r.append("image",e),n.push({name:e.name,modif:"productImage"})}),r.append("imgNames",JSON.stringify(n))),T(r),S(n),r.append("domainKey",c.domainKey),r.append("hash",c._loggedIn.hash),r.append("identifier",c._loggedIn.identifier),r.append("product",JSON.stringify(t)),r.append("shop",null!=(a=null==_?void 0:_.id)?a:null),r.append("status",o),r.append("existing",i),d(!0),setTimeout(function(){d(!1)},1e4),e.next=26,(0,_ecommerce.doPublishProduct)(c.apiUrl,c.domainKey,null!=(a=null==_?void 0:_.id)?a:null,c._loggedIn,t,r);case 26:return a=e.sent,console.log(a),a&&(T(new FormData),S([]),a.product)&&(null!=c&&c.forceOpenRedirectOnDone&&(c.redirect?H.push(c.redirect):c.redirectToProduct&&null!=a&&null!=(l=a.product)&&null!=(l=l.product)&&l.id&&H.push("/pr?p=".concat(a.product.product.id))),a.product.products)&&(u||(f(a.product.products),E(defaultDefinePriceCurrency),m({})),d(!1)),e.abrupt("return",a);case 32:return e.abrupt("return",null);case 33:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()()}catch(e){return null}}function U(t,e){var r,n;return console.log("Product Value",t,e),t.new?(p.meta.currency=e,m(p),e):-1<(n=(r=_toConsumableArray(a)).findIndex(function(e){return e.id===t.id}))?(r[n].meta.currency=e,f(r),e):null}function Y(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"lineup",r=2<arguments.length?arguments[2]:void 0,n=X,a=Z;e&&(e.forEach(function(e){n.append("image",e),a.push({name:e.name,modif:t,id:r})}),n.append("imgNames",JSON.stringify(a))),T(n),S(a)}var H=(0,_router.useRouter)(),e=_slicedToArray(_react.default.useState(!1),2),G=e[0],W=e[1],e=_slicedToArray(_react.default.useState(null),2),B=(e[0],e[1]),e=_slicedToArray(_react.default.useState(!1),2),s=e[0],d=e[1],e=_slicedToArray(_react.default.useState({}),2),e=(e[0],e[1],_slicedToArray(_react.default.useState([]),2)),V=e[0],e=(e[1],_slicedToArray(_react.default.useState([]),2)),a=e[0],f=e[1],e=_slicedToArray(_react.default.useState({}),2),p=e[0],m=e[1],e=_slicedToArray(_react.default.useState(null),2),l=e[0],o=e[1],e=_slicedToArray(_react.default.useState(null),2),i=e[0],u=e[1],e=_slicedToArray(_react.default.useState(Object.assign({},defaultEditingOptionsMeta)),2),y=e[0],g=e[1],e=_slicedToArray(_react.default.useState(null),2),_=e[0],K=e[1],e=_slicedToArray(_react.default.useState({}),2),r=e[0],J=e[1],e=_slicedToArray(_react.default.useState(null),2),h=e[0],$=e[1],e=_slicedToArray(_react.default.useState(0),2),n=e[0],v=e[1],e=_slicedToArray(_react.default.useState(!1),2),t=e[0],Q=e[1],e=_slicedToArray(_react.default.useState(defaultDefinePriceCurrency),2),b=e[0],E=e[1],e=_slicedToArray(_react.default.useState(new FormData),2),X=e[0],T=e[1],e=_slicedToArray(_react.default.useState([]),2),Z=e[0],S=e[1],e=_react.default.useRef(),w=_react.default.useRef(),x=_react.default.useRef(),O=_react.default.useRef(),I=_react.default.useRef(),C=_react.default.useRef(),ee=_react.default.useRef(),te=_react.default.useRef(),re=_react.default.useRef(),P=_react.default.useRef(),ne=_react.default.useRef(),ae=_react.default.useRef(),D=(_react.default.useEffect(function(){var e=c.profile?"shopProfileData":"shop";if(c&&c[e]){for(var t=c[e].products&&Array.isArray(c[e].products)?c[e].products.concat(V):[],e=c[e].shop,r=0;r<a.length&&(0,_util.compareObjects)(a,t);r++);_&&e&&(!e||e.id)||K(e),0===a.length&&0!==t.length&&f(t)}},[c.shopData,c.shopProfileData,V,a]),c._loggedIn&&c._loggedIn.identifier&&c.profileData&&c.profileData.user&&c.profileData.user.id&&c._loggedIn.identifier===c.profileData.user.id),le=_react.default.useCallback(function(e){try{var t,r,n,a;console.log("Start"),(0,_util.isObjectEmpty)(p)&&(null!=_&&_.id||null!=c&&c.forceOpenRedirectOnDone)&&(r=q(),n={id:(0,_uuid.v4)(),shop:null!=(t=null==_?void 0:_.id)?t:null,name:"",detailmeta:{},styles:[r],shipping:[],published:!1,images:[],protype:{type:"virtual",subscription:!1},infinite:!1,meta:{},files:{},new:!0},E(defaultDefinePriceCurrency),m(n),o(r.sid),v(null),$(null),(a=Object.assign({},defaultEditingOptionsMeta)).productType="virtual",g(a),setTimeout(function(){w.current.value=r.style,r.option[0]&&Object.hasOwnProperty.call(r.option[0],"option")&&(x.current.value=r.option[0].option);var e,t=document.getElementById(n.id);null!=t&&t.offsetTop&&null!=(e=window)&&e.scrollTo&&c._isMobile&&window.scrollTo({behavior:"smooth",top:t.offsetTop-5})},200))}catch(e){console.log(e)}}),oe=(_react.default.useEffect(function(){var e;G||(e=(0,_uuid.v4)(),B(e),null!=c&&c.forceOpenRedirectOnDone&&le(),W(!0))},[G,null==c?void 0:c.forceOpenRedirectOnDone]),_react.default.useCallback(function(e){E(defaultDefinePriceCurrency),m({})})),ie=_react.default.useCallback(function(e){var t,r;console.log(e.currentTarget.value),e.currentTarget&&(t=_objectSpread({},p),-1<(r=p.styles.findIndex(function(e){return e.sid===l}))&&(t.styles[r].style=e.currentTarget.value),m(t))}),ue=_react.default.useCallback(function(e){var t,r,n;console.log(e.currentTarget.value,i),e.currentTarget&&-1<(r=(t=_objectSpread({},p)).styles.findIndex(function(e){return e.sid===l}))&&(null==i&&u(p.styles[r].option&&p.styles[r].option[0]?p.styles[r].option[0].sid:""),console.log(r,t.styles[r].option,i),n=t.styles[r].option.findIndex(function(e){return e.sid===i}),console.log(n),-1<n&&(t.styles[r].option[n].option=e.currentTarget.value),m(t))}),ce=_react.default.useCallback(function(e){var t,r,n;e.currentTarget&&-1<(r=(t=_objectSpread({},p)).styles.findIndex(function(e){return e.sid===l}))&&(console.log(r,l,t),n=1===t.styles[r].option.length?0:t.styles[r].option.findIndex(function(e){return e.sid===i}),console.log(n),-1<n&&(isNaN(Number(e.currentTarget.value))||(t.styles[r].option[n].quantity=Number(e.currentTarget.value))),m(t))}),se=_react.default.useCallback(function(e){var t,r;e.currentTarget&&-1<(t=(e=_objectSpread({},p)).styles.findIndex(function(e){return e.sid===l}))&&(-1<(r=1===e.styles[t].option.length?0:e.styles[t].option.findIndex(function(e){return e.sid===i}))&&(!Object.prototype.hasOwnProperty.call(e.styles[t].option[r],"quantity")||e.styles[t].option[r].quantity&&1e7!==e.styles[t].option[r].quantity?e.styles[t].option[r].quantity=Number(1e7):e.styles[t].option[r].quantity=1),m(e))}),de=_react.default.useCallback(function(e){var t,r;e.currentTarget&&-1<(r=(t=_objectSpread({},p)).styles.findIndex(function(e){return e.sid===l}))&&(isNaN(Number(e.currentTarget.value))||("USD"===(null==b?void 0:b.currency)?t.styles[r].price=Number(e.currentTarget.value):(t.styles[r].priceTable||(t.styles[r].priceTable={}),t.styles[r].priceTable[b.currency]=Number(e.currentTarget.value)),m(t)))}),fe=_react.default.useCallback(function(t){var e;console.log(t.currentTarget.value),t.currentTarget&&(o(t.currentTarget.value),e=p.styles.findIndex(function(e){return e.sid===t.currentTarget.value}),w.current.value=p.styles[e].style,console.log(p.styles),setTimeout(function(){x&&x.current&&(x.current.value=p.styles[e].option&&p.styles[e].option[0]?p.styles[e].option[0].option:"",u(p.styles[e].option&&p.styles[e].option[0]?p.styles[e].option[0].sid:""),C.current)&&(C.current.selectedIndex=0)},250),O.current.value=p.styles[e].option&&p.styles[e].option[0]?p.styles[e].option[0].quantity:1,I.current.value=p.styles[e]?p.styles[e].price:1)}),pe=_react.default.useCallback(function(t){var e;console.log(t.currentTarget.value),t.currentTarget&&-1<(e=p.styles.findIndex(function(e){return e.sid===l}))&&(e=p.styles[e].option.find(function(e){return e.sid===t.currentTarget.value}),console.log(e),e)&&(x.current.value=e.option,u(e.sid),O.current.value=e.quantity)}),me=_react.default.useCallback(function(e){var t=_objectSpread({},p);t.styles.push(q()),m(t)}),ye=_react.default.useCallback(function(e){console.log(p,l);var t,r=_objectSpread({},p),n=p.styles.findIndex(function(e){return e.sid===l});console.log(n),-1<n&&(t=L(),p.styles[n].option[0]&&!Object.hasOwnProperty.call(p.styles[n].option[0],"option")?(p.styles[n].option[0].option="",u(p.styles[n].option[0].sid)):(p.styles[n].option.push(t),u(t.sid))),m(r)}),ge=_react.default.useCallback(function(e){var t,r;e.currentTarget&&(e=e.currentTarget.value,(t=_objectSpread({},y)).productType=e,(r=_objectSpread({},p)).protype.type=e,m(r),g(t))}),N=_react.default.useCallback(function(e){console.log(e.currentTarget.checked,e.currentTarget.getAttribute("option")),(0,_Functions.doSetOptionsMetaData)(e,y,p,m,g,n,v)}),_e=(_react.default.useCallback(function(e){var t;e.currentTarget&&e.currentTarget.getAttribute("option")&&(t=_objectSpread({},y),"add"===e.currentTarget.getAttribute("option")?t.lineup&&t.lineup.length<10&&(t.lineup.push(R()),v(t.lineup.length-1),P.current.value="",ne.current.value="",ae.current.value=null):"remove"===e.currentTarget.getAttribute("option")?t.lineup&&0<t.lineup.length&&(t.lineup.pop(),v(-1<t.lineup.length-1?t.lineup.length-1:null),P.current.value="",ne.current.value="",ae.current.value=null):"setSelected"===e.currentTarget.getAttribute("option")&&(e=e.currentTarget.getAttribute("index"),isNaN(e)||(v(e),P.current.value=t.lineup[e].title,ne.current.value=t.lineup[e].description,ae.current.value=t.lineup[e].time)))}),_react.default.useCallback(function(e){var t;e.currentTarget&&e.currentTarget.getAttribute&&e.currentTarget.getAttribute("modif")&&"product_name"===e.currentTarget.getAttribute("modif")&&((t=_objectSpread({},p)).name=e.currentTarget.value,m(t))})),he=_react.default.useCallback(function(e){var t;e.currentTarget&&e.currentTarget.getAttribute&&e.currentTarget.getAttribute("modif")&&(t=e.currentTarget.getAttribute("modif"),e=e.currentTarget.getAttribute("existing"),z(t,e))}),ve=_react.default.useCallback(function(e){return t?(Q(!1),!1):(Q(!0),!0)}),be=_react.default.useCallback(function(e){var t=U(p,e.currentTarget.value);t&&(re.current.innerHTML=t,e=Object.entries(c.regionsData).find(function(e){return e[1].currency===t}))&&e[1]&&(E(e[1]),Ee(e[1]))}),k=_react.default.useCallback(function(e){var t,e=e.currentTarget.value;console.log(e),p&&(t=_objectSpread({},y),console.log(t,y,p),t)&&(t.description=e,(e=_objectSpread({},p)).detailmeta=t,m(e),t)&&g(t)}),A=p&&p.styles?p.styles.find(function(e){return e.sid===l}):null,j=p&&A&&A.option&&(null!=(M=A.option.find(function(e){return e.sid===i}))?M:1===A.option.length)?A.option[0]:null,Ee=function(e){var t;"USD"!==(null==(t=e=e||b)?void 0:t.currency)&&A.priceTable&&Object.prototype.hasOwnProperty.call(A.priceTable,e.currency)?I.current.value=A.priceTable[e.currency]:null!=A&&A.price&&(I.current.value=A.price)},M=(console.log(D,_),_&&_.status&&"nonexistent"===_.status);return console.log(M,p,h,b),console.log(y,n,A,a),_react.default.createElement("div",{className:"".concat(c.className)},_react.default.createElement("div",{className:"".concat(s?"fetchNotBusy fetchBusy":"fetchNotBusy")}),_react.default.createElement("div",{className:"".concat(_ShopModule.default.container," ").concat(c.smaller?"".concat(_ProductImageManagerModule.default.smallContainer):null)},D&&!M?_react.default.createElement("div",{className:"".concat(_ShopModule.default.adminContainer)},_react.default.createElement("div",{className:"heading"},"Shop"),_react.default.createElement("div",{className:"flex options",style:{gap:".25rem"}},_react.default.createElement("button",{disabled:!(0,_util.isObjectEmpty)(p),onClick:le},"Create Product"),p&&!(0,_util.isObjectEmpty)(p)?_react.default.createElement("button",{onClick:oe,modif:"save"},p.new?"Abandon":"Cancel"):null)):null,_react.default.createElement("div",{className:"Product_flex_container"},null!=p&&p.new?_react.default.createElement("div",{className:"".concat(_ProductImageManagerModule.default.currentlyEditingProductContainer," ").concat(null!=c&&c.noFixedPosition?_ProductImageManagerModule.default.currentlyEditingNoFixed:"")},_react.default.createElement("div",{className:"".concat(_ProductImageManagerModule.default.currentEditingProductInnerContainer)},_react.default.createElement("div",{className:"".concat(_ProductImageManagerModule.default.currentlyEditingProductContent)},_react.default.createElement("div",{className:"".concat(_ProductImageManagerModule.default.productImgContainer," Product_img_container Product_img_container_large")},_react.default.createElement(_product.ProductImageManager,_extends({},c,{editing:p,passTempImages:function(e){$({editing:p.id,images:e})}}))),_react.default.createElement("div",{className:"".concat(_ProductImageManagerModule.default.productMetaContainer," Product_meta_container")},_react.default.createElement("div",{style:{height:"calc(100% - ".concat(c._loggedIn?null!=c&&null!=(D=c._loggedIn)&&D.username?"25":"100":"40","px)"),maxHeight:"75vh",overflow:"auto"}},_react.default.createElement("div",null,_react.default.createElement("div",{className:"flex gap-p2"},_react.default.createElement(_Tooltip.default,{title:"Name of Product",placement:"right"},_react.default.createElement("label",{style:{fontWeight:"600"}},"Title: ")),_react.default.createElement("input",{name:"name",placeholder:"Product Title",style:{fontWeight:"600",width:"100%"},onChange:_e,ref:ee,modif:"product_name"})),r.location&&"product_name"===r.location?_react.default.createElement("div",{className:"error"},r.message):null),_react.default.createElement(_Tooltip.default,{title:"Product Description",placement:"left"},_react.default.createElement(_reactTextareaAutosize.default,{className:"".concat(_ProductImageManagerModule.default.textArea),name:"description",placeholder:"Description",defaultValue:null==p||null==(M=p.detailmeta)?void 0:M.description,onChange:k,ref:e})),_react.default.createElement("div",{className:"flex gap-p2",style:{alignItems:"center"}},_react.default.createElement(_Tooltip.default,{title:"Set the price for the currently selected Style",placement:"left"},_react.default.createElement("div",{style:{fontSize:".8rem",fontWeight:600}},null!=(D=null==b?void 0:b.symbol)?D:"$")),_react.default.createElement("input",{type:"currency",style:{width:"100%"},defaultValue:"10.00",ref:I,onChange:de}),A&&"USD"===(null==b?void 0:b.currency)&&A.price!=(null==I||null==(M=I.current)?void 0:M.value)||"USD"!==(null==b?void 0:b.currency)&&(!A.priceTable||A.priceTable&&!A.priceTable[b.currency]||null!=b&&b.currency&&A.priceTable&&Object.prototype.hasOwnProperty.call(A.priceTable,b.currency)&&A.priceTable[b.currency]!=I.current.value)?_react.default.createElement(_Tooltip.default,{title:"The price displayed is currently not set for this product style. Click here to set it"},_react.default.createElement("button",{onClick:de,value:null==I||null==(k=I.current)?void 0:k.value,style:{whiteSpace:"nowrap",lineHeight:".5rem",fontSize:".75rem"}},"Set Price")):null,_react.default.createElement(_Tooltip.default,{title:"You can set pricing in multiple currencies. Although the value you keep selected here will be the primary currency. Use the currency selector to choose a currency to begin setting prices in the respective currency. Countries that users reside in for which you have not set a currency will be presented the closest relevant currency you have defined a pricepoint in"},_react.default.createElement("div",{className:"".concat(_ProductImageManagerModule.default.currencyLabel," ").concat(t?"".concat(_ProductImageManagerModule.default.currencyLabelActive):null),style:{lineHeight:".5rem"},onClick:ve,ref:re},null!=(M=null!=(e=null==b?void 0:b.currency)?e:null==p||null==(D=p.meta)?void 0:D.currency)?M:"USD")),t?_react.default.createElement("div",{className:"".concat(_ProductImageManagerModule.default.setCurrencyExternalContainer)},_react.default.createElement("div",{className:"".concat(_ProductImageManagerModule.default.setCurrencyContainer)},_react.default.createElement("select",{id:p.id+"_setCurrency",name:p.id+"_setCurrency",style:{width:"100%"},onChange:be,ref:te,defaultValue:null!=(k=null==b?void 0:b.currency)?k:"USD"},null!=c&&c.regionsData?Object.entries(c.regionsData).map(function(e){return _react.default.createElement("option",{className:"".concat(_ProductImageManagerModule.default.setCurrencyOption," ").concat("USD"!==e[1].currency&&(null!=A&&A.priceTable&&Object.prototype.hasOwnProperty.call(A.priceTable,e[1].currency)||"USD"===e[1].currency)?_ProductImageManagerModule.default.currencyOptionUsed:null),value:e[1].currency,symbol:e[1].symbol},_react.default.createElement("div",null,e[1].currency),_react.default.createElement("div",null," "),_react.default.createElement("div",null,e[1].name),_react.default.createElement("div",null," "),_react.default.createElement("div",null,e[1].symbol))}):null))):null,_react.default.createElement(_Tooltip.default,{title:"Set the quantity for the currently selected Style & Option combo"},_react.default.createElement("div",{style:{fontSize:".8rem",fontWeight:600,display:j&&j.quantity&&1e7===j.quantity?"none":"block"}},"Qty")),_react.default.createElement("input",{type:"number",style:{width:"100%",display:j&&j.quantity&&1e7===j.quantity?"none":"block"},defaultValue:"100",ref:O,onChange:ce}),_react.default.createElement(_Tooltip.default,{title:"Infinite stock"},_react.default.createElement(_AllInclusive.default,null)),_react.default.createElement("input",{type:"checkbox",style:{margin:0},onChange:se,checked:j&&j.quantity&&1e7===j.quantity})),_react.default.createElement("div",{style:{border:"1px solid #484848",marginTop:".125rem",marginBottom:".25rem"}}),_react.default.createElement("div",{className:"flex",style:{flexWrap:"wrap",gap:".05rem 0.2rem",marginBottom:".125rem"}},_react.default.createElement(_Tooltip.default,{title:"If your product has multiple styles, set them here. A style should be an alternate design or color for a single product that you want to track as single product. For example you might have white, black, grey for t-shirts as individual styles.",placement:"right"},_react.default.createElement("div",{className:"flex gap-p2",style:{alignItems:"center"}},_react.default.createElement("div",{style:{fontSize:".8rem",fontWeight:600}},"Style"),_react.default.createElement("div",{className:"dropdown_input"},_react.default.createElement("input",{type:"text",ref:w,onChange:ie}),_react.default.createElement("select",{id:p.id+"_styles",name:p.id+"_styles",style:{width:"100%"},onChange:fe},(0,_ecommerce.resolveStyles)(p).map(function(e,t){return _react.default.createElement("option",{value:e.sid,className:"style_option",key:t},e.style)}))))),A&&0<A.option.length&&A.option[0]&&Object.hasOwnProperty.call(A.option[0],"option")?_react.default.createElement(_Tooltip.default,{title:"If your product has options, set them here. An option should be a sizing or format choice that exists for all or most styles. For example you might have sizes XS, S, M, L, XL or OS as individual options per style.",placement:"right"},_react.default.createElement("div",{className:"flex gap-p2",style:{alignItems:"center"}},_react.default.createElement("div",{style:{fontSize:".8rem",fontWeight:600}},"Option"),_react.default.createElement("div",{className:"dropdown_input"},_react.default.createElement("input",{type:"text",ref:x,onChange:ue}),_react.default.createElement("select",{id:p.id+"_options",name:p.id+"_options",style:{width:"100%"},onChange:pe,ref:C},p.styles.find(function(e){return e.sid===l}).option.map(function(e,t){return _react.default.createElement("option",{value:e.sid,className:"option_option",key:t},e.option)}))))):null),_react.default.createElement("div",{className:"flex gap-p2 Product_admin_choice_container"},_react.default.createElement("button",{onClick:me},"Add Style"),_react.default.createElement("button",{onClick:ye},"Add Option"),_react.default.createElement(_Tooltip.default,{title:"Set the product type",placement:"right"},_react.default.createElement("div",{className:"flex gap-p2",style:{fontSize:".8rem",alignItems:"center"}},_react.default.createElement("span",{className:"flex"},_react.default.createElement("input",{type:"radio",id:"virtual",name:"fav_language",value:"virtual",defaultChecked:!0,onChange:ge}),_react.default.createElement("label",{for:"virtual"},"Virtual")),_react.default.createElement("span",{className:"flex"},_react.default.createElement("input",{type:"radio",id:"physical",name:"fav_language",value:"physical",onChange:ge}),_react.default.createElement("label",{for:"physical"},"Physical"))))),_react.default.createElement("div",{className:"promptContainer",style:{alignItems:"center",borderRadius:".5rem",margin:".25rem 0"}},_react.default.createElement("div",{className:"flex gap-p2"},_react.default.createElement(_Tooltip.default,{title:"Ticketed Products offer universally unique ids that are unique across the product being sold and can be stamped onto Ticket Images. Virtual Tickets are for Virtual Events. Physical Tickets serve Virtual Tickets for your own In Person Events.",className:"flex gap-p2",style:{alignItems:"center"},placement:"left"},_react.default.createElement("div",{style:{fontSize:".8rem"}},"Is this a ticket?"),_react.default.createElement(_ConfirmationNumber.default,{style:{width:"15px",height:"15px"}})),_react.default.createElement("input",{type:"checkbox",style:{margin:0},value:y.ticket,defaultChecked:y.ticket,onChange:N,option:"ticket"})),y.ticket?_react.default.createElement("div",null,_react.default.createElement(_Tooltip.default,{title:"Please add dates your event is happening. Enter dates in the following format MON-DD-YYYY-HH:MM or they will not be parsed as dates.",className:"flex gap-p2",style:{alignItems:"center"},placement:"right"},_react.default.createElement("span",{style:{fontSize:".8rem",fontWeight:"600",whiteSpace:"nowrap"}},"Date for Event"),_react.default.createElement("input",{type:"text",style:{marginBottom:".125rem",width:"-webkit-fill-available"},placeholder:"Date in MON-DD-YYYY-HH:MM format. If the ticket does not have an event date leave empty",onInput:N,option:"eventDateDef",option2:"input",defaultValue:y.eventDateDef.input})),0<y.eventDateDef.dates.length?_react.default.createElement("div",{className:"tagContainer",style:{marginTop:".25rem",marginBottom:".25rem"}},y.eventDateDef.dates.map(function(e,t){return""!==e?_react.default.createElement("div",{className:"tagItem",key:t},e?(0,_util.getFormattedDate)(e,{pretty:!0}):""):_react.default.createElement("div",null)})):_react.default.createElement("div",null)):null),y&&"virtual"===y.productType?_react.default.createElement("div",null,_react.default.createElement("div",{className:"promptContainer",style:{borderRadius:".5rem",margin:".25rem 0"}},_react.default.createElement("div",{className:"flex gap-p2",style:{alignItems:"center",height:"20px"}},_react.default.createElement(_Tooltip.default,{title:"You can use a date to authorize all users that purchase this ticket for access to your livestreams on that day. Or you can use a tag that you must include in the livestream tags field when you create it. Please use this if you want to put your livestream behind this paywalled purchase",className:"flex gap-p2",style:{alignItems:"center"},placement:"left",paddin:!0},_react.default.createElement("div",{style:{fontSize:".8rem"}},"Is this for a livestream?"),_react.default.createElement(_Stadium.default,{style:{width:"15px"}})),_react.default.createElement("input",{type:"checkbox",style:{margin:0},value:y.livestream,defaultChecked:y.livestream,onChange:N,option:"livestream"})),y.livestream?_react.default.createElement("div",null,_react.default.createElement(_Tooltip.default,{title:"Enter dates or words for matching authorization. Enter dates in the following format MON-DD-YYYY-HH:MM. Time must be input in 24 H military time. Values that do not match dates will be parsed as Tags that can be added to livestreams. Any matches will authorize viewership of the stream for purchases of this ticket",className:"flex gap-p2",style:{alignItems:"center"},placement:"right"},_react.default.createElement("span",{style:{fontSize:".8rem",fontWeight:"600",whiteSpace:"nowrap"}},"Auth Keys | Tags"),_react.default.createElement("input",{type:"text",style:{marginBottom:".125rem",width:"-webkit-fill-available"},placeholder:"Date in DD/MM/YY format or a Tag",onInput:N,option:"livestreamDef",option2:"input",defaultValue:y.livestreamDef.input})),_react.default.createElement("span",{className:"flex gap-p2",style:{marginBottom:".25rem"}},0<y.livestreamDef.dates.length?_react.default.createElement("div",{className:"tagContainer",style:{marginTop:".25rem"}},y.livestreamDef.dates.map(function(e,t){return""!==e?_react.default.createElement("div",{className:"tagItem",key:t},e?(0,_util.getFormattedDate)(e,{pretty:!0}):""):_react.default.createElement("div",null)})):_react.default.createElement("div",null),0<y.livestreamDef.tags.length?_react.default.createElement("div",{className:"tagContainer",style:{marginTop:".25rem"}},y.livestreamDef.tags.map(function(e,t){return""!==e?_react.default.createElement("div",{className:"tagItem",key:t},e):_react.default.createElement("div",null)})):_react.default.createElement("div",null))):null,_react.default.createElement(_product.Lineup,_extends({},c,{product:p,editing:p,editingOptionsMeta:y,setOptionsMetaData:N,currentLineupEditing:n,setCurrentLineupEditing:v,appendFormData:Y})))):_react.default.createElement("div",null),_react.default.createElement("div",{className:"flex gap-p2 promptContainer",style:{alignItems:"center",height:"20px",borderRadius:".5rem",margin:".25rem 0"}},_react.default.createElement(_Tooltip.default,{title:"Allow for your customers to subscribe to your product. This is a guarantee by your company that you will continue to deliver your Product to any subscribed customers. Subscriptions will charge monthly by default.",className:"flex gap-p2",style:{alignItems:"center"},placement:"left"},_react.default.createElement("div",{style:{fontSize:".8rem"}},"Is this a subscription?"),_react.default.createElement(_Inventory.default,{style:{width:"15px"}})),_react.default.createElement("input",{type:"checkbox",style:{margin:0},value:y.subscription,defaultChecked:y.subscription,onChange:N,option:"subscription"}))),null!=c&&c._loggedIn&&null!=c&&null!=(ve=c._loggedIn)&&ve.username?_react.default.createElement("div",{className:"flex gap-p2 Product_admin_choice_container",style:{marginTop:".125rem"}},_react.default.createElement("button",{onClick:he,modif:"publish"},"Publish"),null!=c&&c.forceOpenRedirectOnDone?null:_react.default.createElement("button",{onClick:he,modif:"save"},"Save"),!p||null!=c&&c.forceOpenRedirectOnDone?null:_react.default.createElement("button",{onClick:oe,modif:"save"},p.new?"Abandon":"Cancel")):_react.default.createElement("div",null,_react.default.createElement(_signin.SignIn,c),_react.default.createElement(_signin.Username,c)))))):null,a&&a.map&&!c.hideFeed?a.map(function(e,t){return _react.default.createElement(_product.Product,_extends({},c,{product:e,key:t,apiUrl:c.apiUrl,domainKey:c.domainKey,_loggedIn:c._loggedIn,fetchBusy:s,setFetchBusy:d,_setLoggedIn:c._setLoggedIn,handleEdit:F,editing:p,setEditing:m,setCurrentName:_e,pageError:r,styleInput:w,setCurrentStyleName:ie,changeCurrentStyle:fe,resolveStyles:_ecommerce.resolveStyles,selectedStyle:A,setCurrentOptionName:ue,optionInput:x,changeCurrentOption:pe,optionSelect:C,editingSelectedStyle:l,priceInput:I,setCurrentPrice:de,selectedOption:j,quantityInput:O,setCurrentQuantity:ce,setInfinity:se,addStyle:me,addOption:ye,onProductTypeChange:ge,editingOptionsMeta:y,setEditingOptionsMeta:g,setOptionsMetaData:N,handlePublishProduct:he,publishProduct:z,handleCancelProduct:oe,nameRef:ee,setEditingSelectedStyle:o,setEditingSelectedOption:u,setCombinedFeed:f,setCurrentLineupEditing:v,currentLineupEditing:n,defaultLineup:R,setCurrencySelect:te,changeCurrentCurrency:U,currentDefinePriceCurrency:b,setCurrentDefinePriceCurrency:E,setDefaultPriceHtml:Ee,appendFormData:Y}))}):null)))},_default=exports.default=Module;