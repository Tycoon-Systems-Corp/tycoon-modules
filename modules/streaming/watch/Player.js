import React from"react";import Script from"next/script";import{v4 as uuidv4}from"uuid";import WatchPageStyles from"./WatchPage.module.scss";import Overlay from"/layout/video/Overlay";import IMALoader from"/modules/advertise/video/ima/IMALoader";const Module=a=>{var[e,t]=React.useState(!1);const[l,r]=React.useState(!1),[i,o]=React.useState(null);var c,s=a?.usePlayerHeight??a?.watchUseFullHeight?"calc(100vh - "+a?.menuHeight:"80vh";Object.prototype.hasOwnProperty.call(a,"playerVisible")&&a?.playerVisible||Object.prototype.hasOwnProperty.call(a,"playerVisible");const[n,d]=React.useState(!1);i&&(a._LocalEventEmitter.unsubscribe(i),a._LocalEventEmitter.subscribe(i,e=>{if("healthcheck"===e?.dispatch)try{var t;a?.playerName&&((t=window?.videojs?.players[a.playerName])&&!n?d(!0):!t&&n&&d(!1))}catch(e){}})),React.useEffect(()=>{if(!l){const e=uuidv4();o(e),r((new Date).getTime()),setInterval(()=>{a._LocalEventEmitter.dispatch(e,{dispatch:"healthcheck"})},500)}},[l]);try{!e&&(c=-1!==l&&l<(new Date).getTime()-(a?.waitGoogleImaThreshold??500),window?.google?.ima||a?.noAds||c)&&t(!0)}catch(e){}return console.log("Player Name",a.playerName,e,a.playerInitialized),React.createElement(React.Fragment,null,React.createElement("style",null,`
                    video::-webkit-media-controls-enclosure {
                        display: none;
                    }
                    `),React.createElement(Script,{src:"https://d2zsu4v7czjhvo.cloudfront.net/all/videojs/8.9.0/video.min.js"})," ",React.createElement("div",{className:`${a?.className??""} ${WatchPageStyles.videoContainer} ${a?.mobileStyleConfigs?""+WatchPageStyles.mobileVideoPlayer:null} ${n?WatchPageStyles.playerInitialized+" Watch_PlayerInitialized":WatchPageStyles.playerNotInitialized+" Watch_PlayerNotInitialized"} WatchPage_VideoContainer`},React.createElement("div",{className:WatchPageStyles.floatingCoverPlayer+" Watch_FloatingCoverPlayer"},React.createElement(Overlay,a),React.createElement("video",{id:a.playerName??"my-player",class:WatchPageStyles.videoPlayer+" video-js WatchPage_VideoPlayer "+(a?.loadAds?"ad_video_player":""),style:{maxHeight:s},crossOrigin:"anonymous",controls:!0,preload:"auto",playsInline:!0,poster:(()=>{if(n){if(a?.usePoster)return a.usePoster;if(a?.cdn?.static&&a?.watchData?.thumbtrack?.[0])return a.cdn.static+"/thumbtrack/"+a?.watchData?.thumbtrack[0]}return"/img/default/videoposter-blank.png"})()},React.createElement("p",{class:"vjs-no-js"},"To view this video please enable JavaScript, and consider upgrading to a web browser that",React.createElement("a",{href:"https://videojs.com/html5-video-support/",target:"_blank"},"supports HTML5 video"))),React.createElement("div",{id:"ad-container",className:"no_pointer_events"}))),e&&!a?.noAds?React.createElement(IMALoader,{playerName:a.playerName??"my-player"}):null)};export default Module;