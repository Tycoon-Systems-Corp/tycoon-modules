import{checkiOS}from"/modules/util";function _callback_onAutoplayBlocked(){}function isSafari(){try{var e,r;return window?(e=-1<window.navigator.userAgent.toLowerCase().indexOf("chrome"),r=-1<window.navigator.userAgent.toLowerCase().indexOf("safari"),!e&&r):null}catch(e){return null}}const setAndPlay=(e,r,o)=>{o?.src&&(setSource(e,r,o),ensureAutoPlay(o.play,o))},setSource=(e,r,o)=>{o.src({src:e,type:"hls"===r?"application/x-mpegURL":"application/dash+xml"})},ensureSetSource=(e,r,o,t,n,c)=>{console.log("current src",e?.currentSrc(),"intent src",r?.src),(""===e?.currentSrc()&&""!==r?.src||n)&&(o="live"==(n="Live"==(r=o)?.__typename?"live":"static")||checkiOS()?"hls":"mpd",console.log("use Record",r),r)&&t&&(n="static"==n?t+"/video/"+r[o]:""+r?.meta?.channel?.playbackUrl)&&(console.log("Do Set Src",e,n),e.src({src:n,type:"hls"==o?"application/x-mpegURL":"application/dash+xml"}),"function"==typeof c)&&c()};function ensureAutoPlay(e,r,o){try{if(!window?.imaPlaying){var t=window.Promise?window.Promise.toString():"";if(-1!==t.indexOf("function Promise()")||-1!==t.indexOf("function ZoneAwarePromise()")){try{window?.userInteracted||videoPlayer.muted(!0)}catch(e){}return e().catch(function(e){return"NotAllowedError"==e.name?(console.error("_checkAutoPlay: error.name:","NotAllowedError"),o&&o()):"AbortError"==e.name&&isSafari()?(console.error("_checkAutoPlay: AbortError (Safari)"),o&&o()):console.error("_checkAutoPlay: happened something else ",e),e}).then(function(e){console.log("_checkAutoPlay: then",e)})}console.error("_checkAutoplay: promise could not work in your browser ",e)}}catch(e){return console.log(e),e}}const errorTryReplay=(e,r)=>{if(e?.toString&&/Cannot read properties of undefined/.test(e.toString()))return setTimeout(()=>{try{r&&r.play()}catch(e){console.log("Issue autoplaying after delayed attempt")}},250),null;try{return console.log("Attempt Play",r.play,r),r.play(),setTimeout(()=>{r.hasStarted()||r.play()},10),!0}catch(e){return e}};export default{ensureAutoPlay:ensureAutoPlay,ensureSetSource:ensureSetSource,setAndPlay:setAndPlay,setSource:setSource};export{setAndPlay,setSource,ensureSetSource,ensureAutoPlay};