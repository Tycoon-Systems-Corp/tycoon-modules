import middlewareFunctions from"/customModules/middleware/MiddlewareFunctions";const checkAuth=async(i,t,n,a,d,o,l)=>{if(!await middlewareFunctions.manualAllowResourceAuth(i,t,n))if(i?._loggedIn?.identifier&&i?._loggedIn?.hash){let e=!1;t=(o?.identifier!==i._loggedIn.identifier&&o&&o?.hash!==i._loggedIn.hash&&Object.prototype.hasOwnProperty.call(o,"auth")&&(o.auth=!1),await middlewareFunctions.manualAllowResourceAuth(i,t,n,i._loggedIn.identifier,o));l({identifier:i._loggedIn.identifier,hash:i._loggedIn.hash,auth:t}),a!==(e=t?!0:e)&&d(e)}else a&&d(!1)};export{checkAuth};