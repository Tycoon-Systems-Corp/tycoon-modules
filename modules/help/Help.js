"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=_interopRequireDefault(require("react")),_elasticlunr=_interopRequireDefault(require("../utility/utility/elasticlunr")),_SettingsModule=_interopRequireDefault(require("../settings/Settings.module.scss")),_Close=_interopRequireDefault(require("@mui/icons-material/Close"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,l,n,i,u=[],o=!0,c=!1;try{if(n=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;o=!1}else for(;!(o=(a=n.call(r)).done)&&(u.push(a.value),u.length!==t);o=!0);}catch(e){c=!0,l=e}finally{try{if(!o&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw l}}return u}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var Module=function(t){var e,r=_slicedToArray(_react.default.useState(!1),2),a=r[0],l=r[1],r=_slicedToArray(_react.default.useState(!1),2),r=(r[0],r[1],_slicedToArray(_react.default.useState(null),2)),r=(r[0],r[1],_slicedToArray(_react.default.useState(!0),2)),r=(r[0],r[1],_slicedToArray(_react.default.useState(!1),2)),n=r[0],i=r[1],r=_slicedToArray(_react.default.useState(!1),2),u=r[0],o=r[1],r=_slicedToArray(_react.default.useState(-1),2),c=(r[0],r[1]),r=_slicedToArray(_react.default.useState(null),2),s=r[0],r=r[1],d=_slicedToArray(_react.default.useState([]),2),f=d[0],_=d[1],m=_react.default.useRef(),p=_react.default.useRef(),d=(_react.default.useEffect(function(){a||l(!0)},[a]),a&&_elasticlunr.default&&t.helpIndex&&!s&&r((0,_elasticlunr.default)(function(){var r=this;this.ref("id"),this.field("question"),this.field("answer"),this.field("a"),this.field("meta"),Array.isArray(t.helpIndex)&&t.helpIndex.forEach(function(e,t){e.id=t,r.add(e)})})),_react.default.useEffect(function(){var e;null!=t&&t.open?(i(!0),o(!0),null!=m&&m.current&&clearTimeout(m.current)):t&&null!=t&&t.open||(o(!0),i(!1),e=setTimeout(function(){o(!1),null!=p&&p.current&&(p.current.value=""),m.current=null},1500),m.current=e)},[u,n,null==t?void 0:t.open,null==m?void 0:m.current,null==p?void 0:p.current]),_react.default.useCallback(function(e){c((new Date).getTime());var r,e=null==e||null==(e=e.currentTarget)?void 0:e.value;console.log(e),null!==e&&""!==e&&s&&t.helpIndex?(e=s.search(e,{expand:!0}),r=t.helpIndex.map(function(e,t){return e.id=t,e}),console.log(r,e),e=e.map(function(t){return r.find(function(e){return e.id==t.ref})}),_(e)):y()})),r=_react.default.useCallback(function(e){null!=t&&t.setHelpOpen&&t.setHelpOpen(!1)}),y=function(){var e;null!=p&&p.current&&null!=t&&null!=(e=t.helpIndex)&&e.filter&&((e=p.current.value)&&""!==e||0<(e=t.helpIndex.filter(function(e){return e.pinned})).length&&_(e))};return _react.default.useEffect(function(){y()},[s]),_react.default.useEffect(function(){var e;console.log(t._openMenu),"main_settings"!==(null==t||null==(e=t._openMenu)?void 0:e.currentMenu)&&t.setHelpOpen(!1)},[null==t||null==(e=t._openMenu)?void 0:e.currentMenu]),_react.default.createElement("div",null,_react.default.createElement("div",{className:"Misc_Container ".concat(t.className," ").concat(n&&u?"Misc_Container_Visible":""),style:{top:null!=t&&null!=(e=t.menuConfig)&&e.height&&!isNaN(Number(t.menuConfig.height))?Number(t.menuConfig.height)+"px":""}},_react.default.createElement("div",{className:"Misc_Internal_Container",style:{paddingTop:".5rem"}},_react.default.createElement("div",{style:{position:"sticky",top:".5rem",right:0,zIndex:10}},_react.default.createElement(_Close.default,{className:"".concat(_SettingsModule.default.Close),style:{margin:"0rem 0",float:"right"},onClick:r})),_react.default.createElement("h5",{className:"Misc_Label",style:{marginTop:0}},"Help"),_react.default.createElement("div",{style:{position:"sticky",top:".5rem",margin:".5rem 0",marginTop:"0"}},_react.default.createElement("input",{onChange:d,ref:p,style:{border:"0px",borderRadius:".5rem",width:"87.5%",fontSize:"1.25rem",padding:"0 .5rem"},placeholder:"How can we help?"})),_react.default.createElement("div",{style:{padding:".25rem 0rem",display:"grid",gap:".5rem"}},Array.isArray(f)&&0<f.length?f.map(function(e,t){return null!=e&&e.a?_react.default.createElement("a",{href:e.a,style:{cursor:"pointer"},key:t},_react.default.createElement("div",{className:"Misc_Item_Container Misc_Item_DarkContainerHover",style:{padding:".5rem",display:"grid",gap:".25rem"}},_react.default.createElement("div",{style:{fontWeight:"500"}},e.question),_react.default.createElement("div",{style:{fontSize:".85rem",lineHeight:"normal"}},e.answer))):_react.default.createElement("div",{className:"Misc_Item_Container",style:{padding:".5rem",display:"grid",gap:".25rem"},key:t},_react.default.createElement("div",{style:{fontWeight:"500"}},e.question),_react.default.createElement("div",{style:{fontSize:".85rem",lineHeight:"normal"}},e.answer))}):""!==(null==p||null==(n=p.current)?void 0:n.value)?_react.default.createElement("div",null):_react.default.createElement("div",{style:{textAlign:"center",fontSize:".95rem"}},"Try Searching for something")))))},_default=exports.default=Module;